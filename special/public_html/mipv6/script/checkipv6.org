#!/bin/sh

dnsfile=dns6
mxfile=mx6
wwwfile=www6
for i in $dnsfile $mxfile $wwwfile ; do
	cat /dev/null > $i
done

for i in `cat myndigheter|sort` ; do
	echo "" 1>&2
	echo Checking $i 1>&2
	echo Done with $i 1>&2
	echo "-------------------" 1>&2
	dnscheck=0
	mxcheck=0
	wwwcheck=0

	DNS=`dig +short ns $i`
	for ns in $DNS ; do
		if [ "`host $ns | grep -i '[2][0-9|a-z][0-9|a-z][0-9|a-z]:'`" ] && [ "$dnscheck" = "0" ] ; then
			echo $i >> $dnsfile
			dnscheck=1
		fi
	done
	MX=`dig +short mx $i|awk '{print $2}'`
        for mx in $MX ; do
                if [ "`host $mx | grep -i '[2][0-9|a-z][0-9|a-z][0-9|a-z]:'`"  ] && [ "$mxcheck" = "0" ]; then
			echo $i >> $mxfile
			mxcheck=1
                fi
        done
        if [ "`host www.$i | grep -i '[2][0-9|a-z][0-9|a-z][0-9|a-z]:'`"  ] ; then
			echo $i >> $wwwfile
			wwwcheck=1
        fi
        if [ "`host ipv6.$i | grep -i '[2][0-9|a-z][0-9|a-z][0-9|a-z]:'`"  ] && [ "$wwwcheck" = "0" ] ; then
		if [ "`cat $wwwfile|grep $i`" = "" ] ; then
			echo $i >> $wwwfile
		fi
			
        fi



done
