#!/bin/sh

#kör dnscheck mot definerad lista
function startdnscheck {
	antal=0
	for i in `cat $target` ; do
		echo $i
		timeout 240 nice dnscheck  --policyfile /etc/dnscheck/policy.cron.yaml $i  >"$resultdir"/$i &
		antal=$((antal+1))
		if [ $antal -eq 30 ]; then
			wait
			echo 
			echo $antal klara
			echo 
			antal=0
		fi
	done
	cp -v "$resultdir"/* "$historydir"/$date
		
	echo sover 180 sek
	sleep 180
	for i in `cat $target` ; do
		echo $i
		echo $i | perl expire >> $resultdir/$i
	done
}

function landstingdnscheck {
	for i in `cat landsting` ; do
		echo $i
		dnscheck $i | grep -v "Too few IPv6 name servers" >"$resultdir"/$i &
	done
}